---
import type { CollectionEntry } from 'astro:content';
import Icon from './Icon.astro';

interface Props {
	project: CollectionEntry<'work'>;
}

const { data, slug } = Astro.props.project;
---

<a class="project-card" href={`/work/${slug}`}>
	<div class="card-image-wrapper">
		<img 
			src={data.img} 
			alt={data.img_alt || data.title} 
			loading="lazy" 
			decoding="async"
			class="card-image"
		/>
		<div class="card-overlay"></div>
		<div class="card-icon">
			<Icon icon="arrow-right" size="1.5em" />
		</div>
	</div>
	<div class="card-content">
		<h3 class="card-title">{data.title}</h3>
		{data.description && (
			<p class="card-description">{data.description}</p>
		)}
	</div>
</a>

<style>
	.project-card {
		display: flex;
		flex-direction: column;
		background: var(--gradient-card);
		border: 1px solid var(--gray-800);
		border-radius: var(--radius-xl);
		overflow: hidden;
		box-shadow: var(--shadow-md);
		text-decoration: none;
		transition: all var(--theme-transition);
		position: relative;
		height: 100%;
		transform-style: preserve-3d;
		perspective: 1000px;
	}

	.project-card::before {
		content: '';
		position: absolute;
		inset: 0;
		background: var(--gradient-accent);
		opacity: 0;
		transition: opacity var(--theme-transition);
		z-index: 0;
	}

	.project-card::after {
		content: '';
		position: absolute;
		inset: -2px;
		background: var(--gradient-accent);
		border-radius: var(--radius-xl);
		opacity: 0;
		filter: blur(20px);
		z-index: -1;
		transition: opacity var(--theme-transition);
	}

	.project-card:hover {
		transform: translateY(-8px) rotateX(5deg) rotateY(-5deg) scale(1.02);
		box-shadow: var(--shadow-xl), var(--shadow-glow);
		border-color: var(--accent-regular);
	}

	.project-card:hover::before {
		opacity: 0.08;
	}

	.project-card:hover::after {
		opacity: 0.6;
	}

	.card-image-wrapper {
		position: relative;
		width: 100%;
		aspect-ratio: 16 / 9;
		overflow: hidden;
		background: var(--gray-900);
	}

	.card-image {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform var(--transition-slow);
	}

	.card-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
		opacity: 0;
		transition: opacity var(--theme-transition);
	}

	.card-icon {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%) scale(0.8);
		width: 3.5rem;
		height: 3.5rem;
		display: flex;
		align-items: center;
		justify-content: center;
		background: var(--gradient-accent);
		border-radius: var(--radius-full);
		color: var(--accent-text-over);
		opacity: 0;
		transition: all var(--theme-transition);
		box-shadow: var(--shadow-lg);
	}

	.project-card:hover .card-image {
		transform: scale(1.1);
	}

	.project-card:hover .card-overlay {
		opacity: 1;
	}

	.project-card:hover .card-icon {
		opacity: 1;
		transform: translate(-50%, -50%) scale(1);
	}

	.card-content {
		padding: 1.25rem;
		position: relative;
		z-index: 1;
		flex: 1;
		display: flex;
		flex-direction: column;
		gap: 0.4rem;
		background: linear-gradient(to bottom, transparent, rgba(102, 126, 234, 0.03));
	}

	.card-title {
		font-family: var(--font-brand);
		font-size: var(--text-lg);
		font-weight: 700;
		color: var(--gray-0);
		margin: 0;
		line-height: 1.3;
		transition: all var(--theme-transition);
		position: relative;
		display: inline-block;
	}

	.card-title::after {
		content: '';
		position: absolute;
		bottom: -2px;
		left: 0;
		width: 0;
		height: 2px;
		background: var(--gradient-accent);
		transition: width var(--theme-transition);
	}

	.card-description {
		font-size: var(--text-sm);
		color: var(--gray-300);
		line-height: 1.6;
		margin: 0;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.project-card:hover .card-title {
		color: var(--accent-regular);
		transform: translateX(5px);
	}

	.project-card:hover .card-title::after {
		width: 100%;
	}

	@media (min-width: 50em) {
		.card-content {
			padding: 1.5rem;
		}

		.card-title {
			font-size: var(--text-xl);
		}

		.card-description {
			font-size: var(--text-sm);
			-webkit-line-clamp: 2;
		}
	}
</style>
